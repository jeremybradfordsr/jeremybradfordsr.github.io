!function(e){e.fn.simpleContactForm=function(t){return t=e.extend({errorClass:"error",senderEmail:"",subject:"New message from your website",url:"",type:"POST",clearAfterSend:!0,success:function(){alert("Email sent!")}},t),e(this).each(function(){var a=e(this);e(a).find(".btnSubmit").click(function(s){var r,i,l,n,d=!1,o=t.senderEmail,u=t.url,c="",p="",m=0,h=0,f=!1,b=e(this);if(e(".tmpdata").remove(),e(b).attr("disabled","disabled"),a.is("[action]")&&(u=a.attr("action")),a.find("input,textarea,select").each(function(){l="","submit"!=this.type&&(r=e(this),n="",c=r.attr("id"),p=r.attr("type"),i=null,a.find("label").each(function(){if("checkbox"==p||r.is("select")&&void 0!==r.attr("multiple")&&!1!==r.attr("multiple")){if(r.attr("data_section")==e(this).attr("for"))return i=e(this),l=i.text().trim(),!1}else if(e(this).attr("for")==r.attr("id")||e(this).attr("for")==r.attr("name"))return i=e(this),l=i.text().trim(),!1}),r.removeClass(t.errorClass),c||(c=r.attr("name")),null!=i&&i.removeClass(t.errorClass),r.is("select")?n=r.find(":selected").val():"checkbox"==p?n=r.is(":checked")?"true":"false":"radio"==p?n=r.is(":checked")?"true":"false":"file"==p?(l="",this.files.length>0&&(n=this.files[0].name,m+=parseInt(this.files[0].size),f=!0,h++)):n=r.val(),!r.is(".required")||null!=n&&0!=n.length||(d=!0,r.addClass(t.errorClass),null!=i&&i.addClass(t.errorClass)),r.is(".required")&&"checkbox"==p&&"false"==n&&(d=!0,null!=i&&i.addClass(t.errorClass)),r.is(".required")&&"radio"==p&&"false"==n&&(d=!0,null!=i&&i.addClass(t.errorClass)),(r.is(".email")||r.is(".senderEmail")||"email"==p)&&(function(e){if("-1"!=e.indexOf("@")&&"-1"!=e.indexOf(".")&&""!=e)return!0}(n)||(d=!0,r.addClass(t.errorClass),null!=i&&i.addClass(t.errorClass))),r.is(".senderEmail")&&(o=r.val()),r.is(".email")&&""==o.length&&(o=r.val()),"email"==p&&""==o.length&&(o=r.val()),""!=l&&(n=encodeURIComponent(n),"*"==(l=encodeURIComponent(l)).slice(-1)&&(l=l.substring(0,l.length-1)),c="","checkbox"==p||r.is("select")&&void 0!==r.attr("multiple")&&!1!==r.attr("multiple")?e(a).append('<input class="tmpdata" type="hidden" name="'+e(this).attr("data_section")+'_label" value="'+l+'"/>'):"hidden"!=p&&"checkbox"!=p&&e(a).append('<input class="tmpdata" type="hidden" name="'+e(this).attr("name")+'_label" value="'+l+'"/>')))}),d)e(a).find(".validation-error").show(),e(b).removeAttr("disabled"),e(".tmpdata").remove();else{e(a).find(".required").each(function(t,s){e(a).find(".reqFieldsHelper").remove(),e(a).append('<input type="hidden" class="reqFieldsHelper tmpdata" name="reqFields[]" value="'+e(s).attr("name")+'" />')});var v=e(a).find(".upload_progress"),g=e(a).find(".bar"),_=e(a).find(".percent"),C=e(a).find(".progress"),y="0%";g.width(y),_.html(y),e(a).append('<input class="tmpdata" type="hidden" name="emailSubject" value="'+t.subject+'" />'),e(a).append('<input class="tmpdata" type="hidden" name="emailSender" value="'+o+'" />'),e(a).append('<input class="tmpdata" type="hidden" name="numfiles" value="'+h+'" />'),e.post(u,e(a).serialize()+"&required_size="+m+"&required_size_label=",function(s){if(!s.success)return resultMessage=s.message,""==resultMessage&&(resultMessage="Service temporarily unavailable"),alert(resultMessage),e(b).removeAttr("disabled"),e(".tmpdata").remove(),!1;!f||s.can_submit&&s.can_upload||(f=!1,console.log("Unable to upload file because the file is too large."),e(a).find("input[type=file]").attr("disabled","disabled"),alert("The file(s) could not be uploaded because the file(s) are too large.")),e(a).append('<input class="tmpdata" type="hidden" name="can_upload" value="'+s.can_upload+'" />'),e(a).append('<input class="tmpdata" type="hidden" name="can_submit" value="'+s.can_submit+'" />');var r=m+parseInt(s.space_used),i=parseInt(s.submissions_used)+1;e(a).append('<input class="tmpdata" type="hidden" name="submissions_quota" value="'+s.submissions_quota+'" />'),e(a).append('<input class="tmpdata" type="hidden" name="submissions_used" value="'+i+'" />'),e(a).append('<input class="tmpdata" type="hidden" name="space_used" value="'+r+'" />'),e(a).append('<input class="tmpdata" type="hidden" name="space_quota" value="'+s.space_quota+'" />'),e(a).ajaxSubmit({url:u,beforeSend:function(){f&&(y="0%",g.width(y),_.html(y),e(C).show(),e(v).show())},uploadProgress:function(e,t,a,s){f&&(y=s+"%",g.width(y),_.html(y))},complete:function(s){e(a).find(".upload_progress").hide(),e(a).find("input[type=file]").removeAttr("disabled"),e(b).removeAttr("disabled");try{var r=e.parseJSON(s.responseText)}catch(t){return alert("An error occurred while sending the form. The response could be read. Check the error console for more details."),console.log(t),e(b).removeAttr("disabled"),e(".tmpdata").remove(),!1}r.success?(g.width("100%"),_.html("100%"),t.clearAfterSend&&(e(a).resetForm(),e(".tmpdata").remove(),e(".g-recaptcha").length&&grecaptcha&&grecaptcha.reset()),t.success()):(alert(r.message),r.log&&console.log(r.log),e(C).hide())}})},"json").fail(function(e,t,a){alert("An error occurred while sending the contact form. Check the developer console for errors"),console.log(e),console.log(t),console.log(a)})}return!1})}),e(this)}}(jQuery);