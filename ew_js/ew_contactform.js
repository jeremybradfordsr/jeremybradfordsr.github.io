(function(n){n.fn.simpleContactForm=function(t){function i(){function r(n){if(n.indexOf("@")!="-1"&&n.indexOf(".")!="-1"&&n!="")return!0}var i=n(this);n(i).find(".btnSubmit").click(function(){var u,f,o,e,l=!1,c=t.senderEmail,b=t.url,v="",s="",k=0,d=0,a=!1,y=n(this);if(n(".tmpdata").remove(),n(y).attr("disabled","disabled"),i.is("[action]")&&(b=i.attr("action")),i.find("input,textarea,select").each(function(){o="";this.type!="submit"&&(u=n(this),e="",v=u.attr("id"),s=u.attr("type"),f=null,i.find("label").each(function(){if(s=="checkbox"||u.is("select")&&typeof u.attr("multiple")!=typeof undefined&&u.attr("multiple")!==!1){if(u.attr("data_section")==n(this).attr("for"))return f=n(this),o=f.text().trim(),!1}else if(n(this).attr("for")==u.attr("id")||n(this).attr("for")==u.attr("name"))return f=n(this),o=f.text().trim(),!1}),u.removeClass(t.errorClass),v||(v=u.attr("name")),f!=null&&f.removeClass(t.errorClass),u.is("select")?e=u.find(":selected").val():s=="checkbox"?e=u.is(":checked")?"true":"false":s=="radio"?e=u.is(":checked")?"true":"false":s=="file"?(o="",this.files.length>0&&(e=this.files[0].name,k+=parseInt(this.files[0].size),a=!0,d++)):e=u.val(),u.is(".required")&&(e==undefined||e.length==0)&&(l=!0,u.addClass(t.errorClass),f!=null&&f.addClass(t.errorClass)),u.is(".required")&&s=="checkbox"&&e=="false"&&(l=!0,f!=null&&f.addClass(t.errorClass)),u.is(".required")&&s=="radio"&&e=="false"&&(l=!0,f!=null&&f.addClass(t.errorClass)),(u.is(".email")||u.is(".senderEmail")||s=="email")&&(r(e)||(l=!0,u.addClass(t.errorClass),f!=null&&f.addClass(t.errorClass))),u.is(".senderEmail")&&(c=u.val()),u.is(".email")&&c.length==""&&(c=u.val()),s=="email"&&c.length==""&&(c=u.val()),o!=""&&(e=encodeURIComponent(e),o=encodeURIComponent(o),o.slice(-1)=="*"&&(o=o.substring(0,o.length-1)),v="",s=="checkbox"||u.is("select")&&typeof u.attr("multiple")!=typeof undefined&&u.attr("multiple")!==!1?n(i).append('<input class="tmpdata" type="hidden" name="'+n(this).attr("data_section")+'_label" value="'+o+'"/>'):s!="hidden"&&s!="checkbox"&&n(i).append('<input class="tmpdata" type="hidden" name="'+n(this).attr("name")+'_label" value="'+o+'"/>')))}),l)n(y).removeAttr("disabled"),n(".tmpdata").remove();else{n(i).find(".required").each(function(t,r){n(i).find(".reqFieldsHelper").remove();n(i).append('<input type="hidden" class="reqFieldsHelper tmpdata" name="reqFields[]" value="'+n(r).attr("name")+'" />')});var nt=n(i).find(".upload_progress"),p=n(i).find(".bar"),w=n(i).find(".percent"),g=n(i).find(".progress"),h="0%";p.width(h);w.html(h);n(i).append('<input class="tmpdata" type="hidden" name="emailSubject" value="'+t.subject+'" />');n(i).append('<input class="tmpdata" type="hidden" name="emailSender" value="'+c+'" />');n(i).append('<input class="tmpdata" type="hidden" name="numfiles" value="'+d+'" />');n.post(b,n(i).serialize()+"&required_size="+k+"&required_size_label=",function(r){if(r.success){!a||r.can_submit&&r.can_upload||(a=!1,console.log("Unable to upload file because the file is too large."),n(i).find("input[type=file]").attr("disabled","disabled"),alert("The file(s) could not be uploaded because the file(s) are too large."));n(i).append('<input class="tmpdata" type="hidden" name="can_upload" value="'+r.can_upload+'" />');n(i).append('<input class="tmpdata" type="hidden" name="can_submit" value="'+r.can_submit+'" />');var u=k+parseInt(r.space_used),f=parseInt(r.submissions_used)+1;n(i).append('<input class="tmpdata" type="hidden" name="submissions_quota" value="'+r.submissions_quota+'" />');n(i).append('<input class="tmpdata" type="hidden" name="submissions_used" value="'+f+'" />');n(i).append('<input class="tmpdata" type="hidden" name="space_used" value="'+u+'" />');n(i).append('<input class="tmpdata" type="hidden" name="space_quota" value="'+r.space_quota+'" />');n(i).ajaxSubmit({url:b,beforeSend:function(){a&&(h="0%",p.width(h),w.html(h),n(g).show(),n(nt).show())},uploadProgress:function(n,t,i,r){a&&(h=r+"%",p.width(h),w.html(h))},complete:function(r){var u,f;n(i).find(".upload_progress").hide();n(i).find("input[type=file]").removeAttr("disabled");n(y).removeAttr("disabled");u=n.parseJSON(r.responseText);u.success?(f="100%",p.width(f),w.html(f),t.clearAfterSend&&(n(i).resetForm(),n(".tmpdata").remove(),n(".g-recaptcha").length&&grecaptcha&&grecaptcha.reset()),t.success()):(alert(u.message),u.log&&console.log(u.log),n(g).hide())}})}else return resultMessage=r.message,resultMessage==""&&(resultMessage="Service temporarily unavailable"),alert(resultMessage),n(y).removeAttr("disabled"),n(".tmpdata").remove(),!1},"json")}return!1})}return t=n.extend({errorClass:"error",senderEmail:"",subject:"New message from your website",url:"",type:"POST",clearAfterSend:!0,success:function(){alert("Email sent!")}},t),n(this).each(i),n(this)}})(jQuery)